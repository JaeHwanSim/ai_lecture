---
# https://shorturl.at/4ARVd

---
# 2장. 기초 통계

---

## 1. 데이터 분석과 통계학의 역할

---

### 🔹 (1) 데이터 분석의 목적

* 데이터 분석은 **의사결정을 지원하고 통찰(insight)** 을 제공하는 것이 주된 목적임.
* 수집된 데이터를 통해 **현상을 이해하고 미래를 예측**하며, 문제 해결에 필요한 전략을 수립할 수 있음.

#### 데이터 분석의 대표적인 목적

1. **현상 파악**: 어떤 일이 있었는지를 설명함.
2. **패턴 발견**: 숨겨진 규칙, 관계, 이상값 탐색.
3. **미래 예측**: 과거 데이터를 기반으로 미래 추정.
4. **의사결정 지원**: 다양한 선택지 중 최적 해법 제시.
5. **성과 향상 및 문제 해결**: 분석 결과를 활용해 비용 절감, 품질 개선, 효율성 증가 유도.

---

### 🔹 (2) 통계학의 역할과 필요성

* 통계학은 **데이터를 수집하고 분석하여 정리·해석하는 방법론**임.
* 특히 **불확실성 하에서의 의사결정**을 가능하게 함.

#### 통계학이 제공하는 기능

* 데이터를 요약하여 전반적인 흐름을 이해하게 함.
* 수학적 근거를 통해 객관적 판단을 가능케 함.
* 작은 규모의 표본을 통해 전체 모집단에 대한 결론을 이끌어냄.
* 실험 설계와 결과 검증의 기반 제공.

---

### 🔹 (3) 기술통계와 추론통계

| 구분   | 정의                       | 예시              |
| ---- | ------------------------ | --------------- |
| 기술통계 | 수집된 데이터를 요약하고 시각적으로 표현함  | 평균, 분산, 히스토그램   |
| 추론통계 | 표본 데이터를 기반으로 모집단에 대해 추론함 | 가설검정, 신뢰구간 추정 등 |

* **기술통계**는 데이터를 요약해 직관적으로 이해하도록 도와주며,
* **추론통계**는 **표본을 통해 모집단의 특성을 예측하거나 검정**하는 데 중점을 둠.

---

## ✅ 복습 문제

### Q1. 데이터 분석의 목적과 거리가 먼 것은?

A) 미래 예측

B) 감정 분석

C) 의사결정 지원

D) 현상 이해

**정답: B**

> 감정 분석은 특정 분야의 분석 방법이지만, 데이터 분석의 일반적인 목적은 아님.

---

### Q2. 추론통계에 해당하는 활동은 무엇인가?

A) 히스토그램 작성

B) 평균 계산

C) 표준편차 산출

D) 모집단 평균 추정

**정답: D**

> 표본으로부터 모집단의 특성을 추정하는 것은 추론 통계의 대표적 기능임.

---
## 2. 기초 통계 용어



### 통계 분석의 기본 용어

| 용어   | 설명                     |
| ---- | ---------------------- |
| 변수   | 측정 대상의 속성              |
| 관측값  | 하나의 개체에서 수집된 변수들의 값 집합 |
| 통계량  | 표본으로부터 계산한 값           |
| 모수   | 모집단의 실제 값(알려지지 않음)     |
| 표본오차 | 통계량과 모수 간의 차이          |

---

### 🔹 (1) 데이터와 변수

* **데이터(data)**: 관찰이나 측정을 통해 얻은 사실 또는 값들의 모임임.
* **변수(variable)**: 데이터를 가지는 속성으로, 관측마다 달라질 수 있는 값임(변화가능).

#### 변수의 종류

| 변수 유형  | 설명                 | 예시                  |
| ------ | ------------------ | ------------------- |
| 범주형 변수 | 값이 이름이나 범주로 구분됨    | 성별(남/여), 혈액형(A/B/O) |
| 수치형 변수 | 값이 수치로 표현되며 연산 가능함 | 키, 몸무게, 나이          |
| 이산형 변수 | 셀 수 있는 수치형 변수      | 자녀 수, 결석일 수         |
| 연속형 변수 | 셀 수 없고 연속적인 수치형 변수 | 키, 체온, 소득           |

---

### 🔹 (2) 모집단과 표본

* **모집단(Population)**: 연구 대상 전체 집합임.(예, 전국 고등학생 전체)
* **표본(Sample)**: 모집단 중 실제로 수집한 데이터 집합임.(예, 서울시의 고등학생 300명)

표본은 시간과 비용의 제약 때문에 전체를 조사할 수 없을 때 모집단을 대표하도록 선택됨.

```
+-----------------------------------------------------------+
|                       모집단 (Population)                |
|                                                           |
|  ┌────────────┐  ┌────────────┐  ┌────────────┐           |
|  │ 개체 A     │  │ 개체 B     │  │ 개체 C     │   ...     |
|  └────────────┘  └────────────┘  └────────────┘           |
|     ⋮                   ⋮                   ⋮             |
|                                                           |
|     <------ 전체 대상 중 일부를 선택 (표본 추출) ------>  |
|                                                           |
|                    +--------------------+                |
|                    |    표본 (Sample)   |                |
|                    |                    |                |
|                    |  개체 B, 개체 C, ...|               |
|                    +--------------------+                |
+-----------------------------------------------------------+
```

### 설명:

* **모집단**은 우리가 관심 있는 전체 집단(예: 모든 한국 성인 남성, 전체 환자 등)을 의미함.
* **표본**은 모집단 중에서 실제로 **선택하여 조사하거나 측정한 일부 대상**임.
* 표본을 통해 **모집단의 특성을 추정하거나 검정**하는 것이 추론 통계의 핵심 목적임.

---

### 🔹 (3) 통계량과 모수

| 용어  | 정의                                      | 예시                 |
| --- | --------------------------------------- | ------------------ |
| 통계량 | 표본에서 계산된 수치 (sample statistic)          | 표본 평균, 표본 분산 등     |
| 모수  | 모집단의 특성을 나타내는 수치 (population parameter) | 모집단 평균, 모집단 표준편차 등 |

* **통계량**은 관측된 데이터로부터 실제 계산 가능하지만,
* **모수**는 일반적으로 알려져 있지 않으며 추정의 대상이 됨.


---
## ✅ 복습 문제

### Q1. 다음 중 **연속형 변수**에 해당하는 것은?

A) 혈액형

B) 몸무게

C) 자녀 수

D) 성별

**정답: B**

> 몸무게는 정밀하게 실수 단위로 측정되며, 연속적인 값을 가질 수 있음.

---

### Q2. 통계량(statistic)과 모수(parameter)의 차이에 대한 설명으로 옳은 것은?

A) 통계량은 모집단 전체에 대해 계산된다.

B) 모수는 항상 계산이 가능하다.

C) 통계량은 표본에서 계산되는 수치이다.

D) 모수는 데이터 없이도 예측할 수 있다.

**정답: C**

> 통계량은 표본을 통해 실제로 계산할 수 있는 수치임.

---

## 💻 실습

### 실습 1) 변수의 유형 자동 분류하기

Pandas를 사용하여 데이터프레임에서 각 변수의 데이터 유형을 파악하시오.

```python
import pandas as pd

data = {
    '성별': ['남', '여', '여', '남'],
    '나이': [23, 21, 25, 24],
    '혈액형': ['A', 'B', 'O', 'AB'],
    '키': [175.5, 162.0, 158.4, 180.2]
}

df = pd.DataFrame(data)
print(df.dtypes)
```

| 함수               | 설명             | 주요 파라미터     |
| ---------------- | -------------- | ----------- |
| `pd.DataFrame()` | 데이터프레임 생성      | 딕셔너리, 리스트 등 |
| `.dtypes`        | 각 열의 데이터 유형 반환 | 없음          |

---

### 실습 2) 변수 분류 시각화 (범주형 vs 수치형)

데이터프레임에서 수치형 변수와 범주형 변수의 수를 시각화하시오.

```python
import matplotlib.pyplot as plt

num_vars = df.select_dtypes(include=['number']).columns
cat_vars = df.select_dtypes(include=['object']).columns

plt.bar(['수치형 변수', '범주형 변수'], [len(num_vars), len(cat_vars)])
plt.title("변수 유형 분포")
plt.show()
```

| 함수/속성             | 설명             | 주요 파라미터                |
| ----------------- | -------------- | ---------------------- |
| `select_dtypes()` | 특정 데이터 유형 열 선택 | `include=['number']` 등 |
| `plt.bar()`       | 막대 그래프 생성      | x값, y값                 |
| `plt.show()`      | 시각화 출력         | 없음                     |

---
### 문제 3) 데이터 요약 통계량 구하기

다음 리스트의 평균, 중앙값, 분산을 계산하시오.

```python
import numpy as np

data = [12, 18, 25, 30, 45, 50]

mean = np.mean(data)
median = np.median(data)
variance = np.var(data)

print(f"평균: {mean}, 중앙값: {median}, 분산: {variance}")
```

| 함수            | 기능 설명      | 주요 파라미터             |
| ------------- | ---------- | ------------------- |
| `np.mean()`   | 배열의 평균 계산  | 배열                  |
| `np.median()` | 배열의 중앙값 계산 | 배열                  |
| `np.var()`    | 배열의 분산 계산  | 배열, `ddof=0` 기본값 사용 |
---

### 문제 4) 표본 평균과 표본 표준편차 계산

모집단에서 임의 표본을 추출하고, 표본의 평균과 표준편차를 계산하시오.
모집단과 표본의 평균을 비교하시오.

```python
import numpy as np

population = np.array([160, 165, 170, 175, 180, 185])
sample = np.random.choice(population, size=3, replace=False)


print("모집단 평균:", np.mean(population))

sample_mean = np.mean(sample)
sample_std = np.std(sample, ddof=1)  # 표본 표준편차

print(f"표본: {sample}")
print(f"표본 평균: {sample_mean:.2f}, 표준편차: {sample_std:.2f}")


```

| 함수                   | 설명             | 주요 파라미터                |
| -------------------- | -------------- | ---------------------- |
| `np.random.choice()` | 배열에서 무작위 표본 추출 | 배열, 크기,  replace=False |
| `np.std()`           | 표준편차 계산        | `ddof=1`로 설정 시 표본 기준   |

---


---
## 3. 데이터의 분포와 시각화

---

### 🔹 (1) 데이터 분포란?

* **데이터의 분포(distribution)**는 관측값이 어떻게 퍼져 있는지를 보여주는 통계적 개념임.
* 분포를 파악하면 데이터의 **중심, 변동성, 대칭성, 극단값(이상치)** 등을 이해할 수 있음.

---

### 🔹 (2) 데이터 시각화 방법

#### 1) 히스토그램 (Histogram): 구간별 빈도 시각화 

* 데이터를 구간(bin)으로 나누고, 각 구간에 해당하는 관측값의 개수를 막대로 표시함.
* 연속형 변수의 분포 형태(정규, 왜도 등),  중심, 산포를 파악할 수 있음.

#### 2) 박스플롯 (Boxplot): 사분위수와 이상치 시각화

* 데이터의 **중앙값, 사분위수(Q1, Q3), 범위, 이상치**를 직관적으로 보여줌.
* 데이터의 중앙 경향, 이상치 존재 여부를 파악하기 좋음.

#### 3) 밀도함수 그래프 (KDE: Kernel Density Estimation): 연속적 분포 추정 

* 데이터를 부드러운 곡선 형태로 나타내어 **확률밀도 함수 추정**에 사용됨.
* 히스토그램보다 부드러운 분포 곡선으로 시각화함.

---

### 🔹 (3) 왜도(Skewness)와 첨도(Kurtosis)

| 개념 | 설명           | 해석 기준                     |
| -- | ------------ | ------------------------- |
| 왜도 | 분포의 비대칭성 측정값 | 0이면 대칭, 음수는 좌왜도, 양수는 우왜도  |
| 첨도 | 분포의 뾰족한 정도   | 0이면 정규, >0이면 뾰족, <0이면 평평함 |

---

## ✅ 복습 문제

### Q1. 박스플롯(boxplot)으로 확인하기 어려운 정보는?

A) 이상치

B) 평균

C) 중앙값

D) 사분위수

**정답: B**

> 박스플롯은 중앙값(Median)은 표시하지만, 평균(Mean)은 직접적으로 제공하지 않음.

---

### Q2. 왜도 값이 양수일 경우 데이터의 분포는?

A) 좌측으로 치우친다

B) 정규분포이다

C) 우측으로 치우친다

D) 평균 = 중앙값이다

**정답: C**

> 왜도가 양수인 경우는 데이터가 오른쪽으로 긴 꼬리를 가지는 **우왜(right-skewed)** 상태임.

---

## 💻 실습 

### 문제 1) 데이터 시각화로 분포 확인하기

주어진 데이터를 히스토그램으로 시각화하시오.

```python
import matplotlib.pyplot as plt

data = [12, 18, 25, 30, 45, 50]

plt.hist(data, bins=5, edgecolor='black')
plt.title("데이터 분포 히스토그램")
plt.xlabel("값")
plt.ylabel("빈도")
plt.show()
```

| 함수            | 기능 설명     | 주요 파라미터                     |
| ------------- | --------- | --------------------------- |
| `plt.hist()`  | 히스토그램 생성  | `data`, `bins`, `edgecolor` |
| `plt.title()` | 그래프 제목 지정 | 문자열                         |
| `plt.xlabel()`  | x축 라벨 설정 | 문자열     |
| `plt.ylabel()`  | y축 라벨 설정 | 문자열     |
| `plt.show()`  | 그래프 출력    | 없음                          |
---

### 문제 2) 정규분포 히스토그램

랜덤 정규분포 데이터를 생성하고 히스토그램으로 시각화하시오.

```python
import numpy as np
import matplotlib.pyplot as plt

data = np.random.normal(loc=50, scale=10, size=1000)

plt.hist(data, bins=30, edgecolor='black')
plt.title("정규분포 히스토그램")
plt.xlabel("값")
plt.ylabel("빈도")
plt.show()
```

| 함수                   | 기능 설명        | 주요 파라미터                     |
| -------------------- | ------------ | --------------------------- |
| `np.random.normal()` | 정규분포에서 난수 생성 | `loc`, `scale`, `size`      |

---

### 문제 3) 박스플롯으로 이상치 시각화하기

키 데이터를 박스플롯으로 시각화하고 이상치를 확인하시오.

```python
import matplotlib.pyplot as plt

heights = [160, 162, 165, 170, 175, 180, 185, 190, 250]  # 250은 이상치

plt.boxplot(heights)
plt.title("키의 박스플롯")
plt.ylabel("키(cm)")
plt.show()
```

| 함수              | 기능 설명    | 주요 파라미터 |
| --------------- | -------- | ------- |
| `plt.boxplot()` | 박스플롯 시각화 | `data`  |
---

### 문제 4) 밀도함수 곡선 (KDE plot) 그리기

Seaborn을 사용하여 표준정규분포의 밀도곡선을 시각화하시오.

```python
import seaborn as sns
import numpy as np
import matplotlib.pyplot as plt

data = np.random.normal(loc=0, scale=1, size=500)

sns.kdeplot(data, fill=True)
plt.title("밀도 곡선 (KDE)")
plt.show()
```

| 함수              | 기능 설명           | 주요 파라미터               |
| --------------- | --------------- | --------------------- |
| `sns.kdeplot()` | 커널 밀도 추정 곡선 시각화 | `data`, `fill=True` 등 |


---

## 4. 중심 경향과 산포

---

### 🔹 (1) 중심 경향 (Measures of Central Tendency)

* 중심 경향은 데이터가 **어디를 중심으로 분포하고 있는지**를 나타냄.
* 대표적으로 **평균(Mean)**, **중앙값(Median)**, **최빈값(Mode)**이 있음.

#### 1) 평균 (Mean)

* 모든 값을 더한 후 데이터 개수로 나눈 값임.
* 이상치에 매우 민감함.

#### 2) 중앙값 (Median)

* 데이터를 크기순으로 정렬했을 때 **가운데 위치한 값**임.
* 이상치에 덜 민감함.

#### 3) 최빈값 (Mode)

* **가장 자주 나타나는 값**임.
* 범주형 변수에 적합.

---

### 🔹 (2) 산포도 (Measures of Dispersion)

* 산포도는 데이터가 **얼마나 흩어져 있는지**를 나타냄.
* 중심 경향만으로는 데이터의 분포를 충분히 설명할 수 없기 때문에 산포도와 함께 해석해야 함.

#### 주요 산포 지표

| 지표                       | 정의                         | 계산식                                          |
| ------------------------ | -------------------------- | -------------------------------------------- |
| 범위(Range)                | 최댓값 - 최솟값                  | $R = x_{\max} - x_{\min}$                    |
| 분산(Variance)             | 값이 평균에서 얼마나 떨어져 있는지의 제곱 평균 | $s^2 = \frac{1}{n-1} \sum (x_i - \bar{x})^2$ |
| 표준편차(Standard Deviation) | 분산의 제곱근, 해석이 쉬운 산포 지표 | $s = \sqrt{s^2}$                             |
| 사분위범위(IQR)               | Q3 - Q1 (중간 50% 범위)        | $\text{IQR} = Q_3 - Q_1$                     |

---

### 🔹 (3) 이상치(Outlier)의 영향

* **평균은 이상치에 매우 민감함**. 반면 중앙값은 영향을 덜 받음.
* 따라서 **데이터에 이상치가 존재할 경우 중앙값을 대표값으로 사용하는 것이 적절**함.


| 항목    | 설명               | 특징           |
| ----- | ---------------- | ------------ |
| 평균    | 산술 평균            | 이상치에 민감      |
| 중앙값   | 정렬된 값의 가운데 값     | 이상치에 강건함     |
| 최빈값   | 가장 많이 나타난 값      | 범주형 변수에 적합   |
| 범위    | 최대값과 최소값의 차이     | 극단값에 영향받음    |
| 사분위범위 | 중간 50% 데이터의 범위   | 이상치에 덜 민감    |

---

## ✅ 복습 문제

### Q1. 다음 중 이상치에 가장 민감한 중심 경향 지표는?

A) 중앙값

B) 최빈값

C) 평균

D) 사분위수

**정답: C**

> 평균은 모든 값에 영향을 받기 때문에 극단값(이상치)에 매우 민감함.

---

### Q2. 데이터의 분산이 크다는 의미로 적절한 것은?

A) 데이터가 평균 근처에 몰려 있다

B) 이상치가 없다

C) 값들이 넓게 퍼져 있다

D) 데이터가 정규분포를 따른다

**정답: C**

> 분산이 크다는 것은 데이터가 평균으로부터 멀리 떨어진 값들이 많다는 뜻임.

---

## 💻 실습 

### 문제 1) 중심 경향 값 계산하기

주어진 데이터의 평균, 중앙값, 최빈값을 구하시오.

```python
import numpy as np
from scipy import stats

data = [10, 10, 20, 30, 30, 30, 40, 100]

mean = np.mean(data)
median = np.median(data)
mode = stats.mode(data, keepdims=True)[0][0]

print(f"평균: {mean}, 중앙값: {median}, 최빈값: {mode}")
```

| 함수 / 모듈        | 기능 설명  | 주요 파라미터            |
| -------------- | ------ | ------------------ |
| `np.mean()`    | 평균 계산  | 배열                 |
| `np.median()`  | 중앙값 계산 | 배열                 |
| `stats.mode()` | 최빈값 계산 | `keepdims=True` 권장 |

---

### 문제 2) 산포 지표 계산하기

표본의 분산, 표준편차, 범위를 계산하시오.

```python
data = [10, 10, 20, 30, 30, 30, 40, 100]

variance = np.var(data, ddof=1)
std_dev = np.std(data, ddof=1)
value_range = np.max(data) - np.min(data)

print(f"표본 분산: {variance:.2f}, 표준편차: {std_dev:.2f}, 범위: {value_range}")
```

| 함수                     | 기능 설명     | 주요 파라미터             |
| ---------------------- | --------- | ------------------- |
| `np.var()`             | 분산 계산     | `ddof=1` 설정 시 표본 기준 |
| `np.std()`             | 표준편차 계산   | `ddof=1` 설정 시 표본 기준 |
| `np.max()`, `np.min()` | 최대/최소값 계산 | 배열                  |

---

### 문제 3) 사분위수 및 사분위범위(IQR) 계산

데이터의 Q1, Q3, IQR을 계산하시오.

```python
import numpy as np

data = [10, 10, 20, 30, 30, 30, 40, 100]

Q1 = np.percentile(data, 25)
Q3 = np.percentile(data, 75)
IQR = Q3 - Q1

print(f"Q1: {Q1}, Q3: {Q3}, IQR: {IQR}")
```

| 함수                | 기능 설명     | 주요 파라미터             |
| ----------------- | --------- | ------------------- |
| `np.percentile()` | 특정 분위수 계산 | `data`, 분위값(0\~100) |

---


## 5. 확률의 기초

---

### 🔹 (1) 확률의 정의

* **확률(probability)**은 어떤 사건이 발생할 가능성의 정도를 수치로 나타낸 것임.
* 확률의 범위는 **항상 0 이상, 1 이하**임.

#### 확률의 기본 공식

* 실험에서 가능한 전체 경우의 수가 $n$, 관심 있는 경우의 수가 $k$일 때

  $$
  P(A) = \frac{k}{n}
  $$


* 사건 A의 확률

어떤 실험에서 사건 A가 일어날 확률은 다음과 같이 정의됨:

$$
P(A) = \frac{\text{사건 A가 일어나는 경우 수}}{\text{전체 가능한 경우 수}}
$$

---

### 🔹 (2) 확률의 기본 성질

#### 1) 확률의 범위

* 모든 사건 $A$에 대해:

  $$
  0 \leq P(A) \leq 1
  $$

#### 2) 전체 사건의 합

* 전체 가능한 사건의 확률 합은 1임:

  $$
  P(S) = 1
  $$

#### 3) 여사건의 확률

* 사건 A가 **일어나지 않을 확률**은 **여사건 Aᶜ**이라고 하고 다음과 같이 계산함:

$$
P(A^c) = 1 - P(A)
$$

> 예: 동전을 던졌을 때 앞면이 나올 확률이 0.5라면, 뒷면이 나올 확률은 $1 - 0.5 = 0.5$
---
### (3) 조건부 확률 (Conditional Probability)

* 어떤 사건 B가 이미 일어난 상황에서 사건 A가 일어날 확률:

  $$
  P(A \mid B) = \frac{P(A \cap B)}{P(B)}
  $$

* 조건부 확률은 사건 간의 **의존 관계**를 분석할 때 사용됨.
* 두 원의 겹치는 부분이 $A \cap B$, 즉 A와 B가 동시에 일어나는 영역임.
* 조건부 확률은 **B가 일어났다는 전제 하에, A가 일어날 확률**이므로 겹치는 영역의 상대적 비중으로 해석됨.

<img src="ConditionalProbability.PNG"  alt="조건부확률 벤 다이어그램"> 


---
### 🔹 (4) 확률의 연산

#### 1) 덧셈법칙(Addition Rule) (두 사건 A, B의 합집합)

#### ① 배타적(서로 겹치지 않는) 사건 A, B:

$$
P(A \cup B) = P(A) + P(B)
$$

> 예: 주사위를 던졌을 때 1 또는 6이 나올 확률
> → $P(1 \cup 6) = P(1) + P(6) = \frac{1}{6} + \frac{1}{6} = \frac{2}{6}$

---

####  ② 일반적인 사건 A, B (겹칠 수 있음):

$$
P(A \cup B) = P(A) + P(B) - P(A \cap B)
$$

겹치는 경우를 한 번만 포함해야 하므로, 중복된 교집합 $P(A \cap B)$을 빼줌.

---

#### 2) 곱셈 법칙 (Multiplication Rule)


| 구분 | 정의                         | 수식 조건                           |
| -- | -------------------------- | ------------------------------- |
| 독립 | A의 발생 여부가 B의 발생에 영향을 주지 않음 | $P(A \cap B) = P(A) \cdot P(B)$ |
| 종속 | A의 발생 여부가 B의 발생 확률에 영향을 줌  | $P(A \mid B) \ne P(A)$          |



#### ① 독립 사건 A, B:

$$
P(A \cap B) = P(A) \cdot P(B)
$$

> 예: 두 개의 주사위를 동시에 던졌을 때, 첫 번째가 3이고 두 번째가 4가 나올 확률
> → $\frac{1}{6} \cdot \frac{1}{6} = \frac{1}{36}$

---
#### ② 종속 사건 (조건부 확률 포함):

$$
P(A \cap B) = P(A) \cdot P(B|A)
$$

또는

$$
P(A \cap B) = P(B) \cdot P(A|B)
$$

* 사건 A가 일어난 조건에서 B가 일어날 확률을 곱함.
* 조건부 확률: $P(B|A) = \frac{P(A \cap B)}{P(A)}$

---

## ✅ 복습 문제

### Q1. 두 사건 A와 B가 서로 독립일 때 성립하는 식은?

A) $P(A|B) = 0$

B) $P(A \cup B) = 1$

C) $P(A \cap B) = P(A) + P(B)$

D) $P(A \cap B) = P(A) \cdot P(B)$

**정답: D**

> 독립 사건의 기본 조건은 $P(A \cap B) = P(A) \cdot P(B)$임.

---

### Q2. 확률 $P(A) = 0.7$ 일 때 여사건의 확률은?

A) 0.3

B) 0.7

C) 1.3

D) -0.7

**정답: A**

> $P(A^c) = 1 - 0.7 = 0.3$

---

## 💻 실습 

### 문제 1) 확률의 기본 성질 확인

임의의 사건 A, B에 대해 기본적인 확률 공식이 성립하는지 확인하시오.

```python
P_A = 0.6
P_B = 0.5
P_A_and_B = 0.3

P_A_or_B = P_A + P_B - P_A_and_B
P_A_complement = 1 - P_A

print(f"P(A ∪ B): {P_A_or_B}")
print(f"P(Aᶜ): {P_A_complement}")
```

| 변수 / 수식          | 설명          |
| ---------------- | ----------- |
| `P_A`, `P_B`     | 사건 A, B의 확률 |
| `P_A_or_B`       | 덧셈법칙 적용     |
| `P_A_complement` | 여사건 확률 계산   |

---

### 문제 2) 독립 사건 조건 검정

두 사건 A, B가 독립인지 확률 곱 규칙을 이용해 판단하시오.

```python
P_A = 0.5
P_B = 0.3
P_A_and_B = 0.15

independent = np.isclose(P_A_and_B, P_A * P_B)

print(f"독립 사건인가? {independent}")
```

| 함수             | 설명          | 주요 파라미터 |
| -------------- | ----------- | ------- |
| `np.isclose()` | 실수값의 근사적 비교 | 두 값 비교  |
---

### 문제 3) 조건부 확률 계산하기

사건 A ∩ B, 사건 B의 확률이 주어졌을 때 조건부 확률을 구하시오.

```python
P_B = 0.4
P_A_and_B = 0.2

P_A_given_B = P_A_and_B / P_B
print(f"P(A|B): {P_A_given_B}")
```

| 수식 / 변수       | 설명               |         |
| ------------- | ---------------- | ------- |
| `P_A_and_B`   | A와 B가 동시에 일어날 확률 |         |
| `P_A_given_B` | 조건부 확률 ( P(A     | B) ) 계산 |

---

### 문제 4) 곱셈 법칙과 조건부 확률 계산

사건 A가 일어날 확률이 0.6이고, 사건 B가 A가 일어났을 때 일어날 조건부 확률이 0.5일 때:

1. $P(A \cap B)$ 계산
2. $P(B|A)$를 재계산하여 확인

```python
P_A = 0.6
P_B_given_A = 0.5

P_A_and_B = P_A * P_B_given_A
P_B_given_A_check = P_A_and_B / P_A  # 조건부 확률 확인용

print(f"P(A ∩ B) = {P_A_and_B}")
print(f"P(B|A) = {P_B_given_A_check}")
```

| 기호/함수               | 설명            |
| ------------------- | ------------- |
| `P_A * P_B_given_A` | 곱셈법칙 (조건부 포함) |
| `P_A_and_B / P_A`   | 조건부 확률 공식     |
---

## 6. 베이즈 정리 (Bayes’ Theorem)

조건부 확률을 **역방향**으로 계산할 수 있는 공식임:

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

* **후행 확률**을 **사전 확률과 우도**로 계산할 수 있음.
* 머신러닝의 나이브 베이즈 분류기 등에서 핵심적으로 활용됨.

---

### 🔹 실습. 베이즈 정리

> 어떤 질병에 걸릴 확률은 0.01이며, 이 질병에 걸린 사람이 양성 반응을 보일 확률은 0.99이다. 
> 질병에 걸리지 않은 사람이 양성 반응을 보일 확률은 0.05이다. 
> 어떤 사람이 양성 반응을 보였을 때, 그가 실제로 질병에 걸렸을 확률을 계산하시오. 

```python
# 사전 확률
P_Disease = 0.01
P_NoDisease = 1 - P_Disease

# 우도
P_Positive_given_Disease = 0.99
P_Positive_given_NoDisease = 0.05

# 전체 양성 확률 (전확률 법칙)
P_Positive = (P_Positive_given_Disease * P_Disease) + \
             (P_Positive_given_NoDisease * P_NoDisease)

# 베이즈 정리
P_Disease_given_Positive = (P_Positive_given_Disease * P_Disease) / P_Positive

print(f"P(질병|양성) = {P_Disease_given_Positive:.4f}")
```


| 기호/수식  | 설명                |                     |
| ------ | ----------------- | ------------------- |
| `P(D)` | 질병에 걸릴 확률 (사전 확률) |                     |
| \`P(+|D)\`    | 질병 있을 때 양성일 확률 (우도) |
| `P(+)` | 전체 양성 확률 (전확률법칙)  |                     |
| \`P(D|+)\`    | 양성일 때 질병일 확률 (베이즈)  |

---

## 7. 확률 분포

---

### 🔹 (1) 확률 분포의 개념

* **확률 분포(Probability Distribution)**란 **무작위 변수(random variable)**가 취할 수 있는 값들과 그에 대응하는 확률의 관계를 나타낸 것임.
* 확률 분포는 **이산형**과 **연속형**으로 구분됨.

---

### 🔹 (2) 이산 확률 분포 (Discrete Probability Distribution)

* 확률 변수가 **특정 값(이산적 값)**만 가질 수 있는 경우.
* 확률 질량 함수(PMF, Probability Mass Function)를 사용함.
* 주요 예: **이항 분포**, **포아송 분포**


#### 1) 이항 분포 (Binomial Distribution)

* n번의 독립 시행 중 성공 횟수 X의 분포
* 성공 확률 p, 실패 확률 1-p
* 확률 질량 함수:

  $$
  P(X = k) = \binom{n}{k} p^k (1 - p)^{n - k}
  $$

<img src="binomial_n20_p_comparison.PNG">


#### 2) 포아송 분포 (Poisson Distribution)

* 단위 시간 또는 단위 공간에서 사건이 일정한 평균 λ로 발생하는 분포
* 확률 질량 함수:

  $$
  P(X = k) = \frac{\lambda^k e^{-\lambda}}{k!}
  $$

---

### 🔹 (3) 연속 확률 분포 (Continuous Probability Distribution)

* 확률 변수가 **연속적인 값을 가질 수 있음**
* 확률 밀도 함수(PDF, Probability Density Function)로 표현됨
* 주요 예: **정규 분포**

#### 1) 정규 분포 (Normal Distribution)


정규 분포(Normal Distribution)는 통계학에서 가장 핵심적인 확률분포 중 하나로, **자연현상, 사회현상, 생물학적 데이터 등** 다양한 분야에서 매우 자주 나타남. 



#####  정규 분포의 특징

| 항목           | 설명                   |
| ------------ | -------------------- |
| 모양           | 좌우 대칭의 종형            |
| 평균, 중앙값, 최빈값 | 모두 동일                |
| 전체 면적        | 1                    |
| 중심극한정리       | 표본의 평균 분포가 정규분포로 수렴함 |


##### 확률 밀도 함수:


$$
f(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{- \frac{(x - \mu)^2}{2\sigma^2}}
$$


* 평균 $\mu$: 분포의 중심
* 표준편차 $\sigma$: 분포의 퍼짐 정도


* **면적의 의미**:  확률: 전체 면적은 1이며, 특정 구간의 면적은 해당 범위에 포함될 확률 


---

##### 표준편차(σ)에 따른 데이터 포함 비율

정규분포에서는 **평균을 중심으로 표준편차 범위 내에 있는 데이터의 비율**이 통계적으로 정해져 있음:

| 범위                | 포함 비율 (확률) | 의미         |
| ----------------- | ---------- | ---------- |
| $\mu \pm 1\sigma$ | 약 68.27%   | 데이터의 약 2/3 |
| $\mu \pm 2\sigma$ | 약 95.45%   | 대부분의 데이터   |
| $\mu \pm 3\sigma$ | 약 99.73%   | 거의 모든 데이터  |

> ✅ 이 특성은 "68–95–99.7 법칙" 또는 "Empirical Rule"이라고 불림.

---

#### 2) Z-분포 (표준정규분포, Standard Normal Distribution)


<img src="standard_normal_distribution.PNG">


정규분포의 **특수한 형태**로, 평균이 0이고 표준편차가 1인 정규분포임.

$$
Z = \frac{X - \mu}{\sigma}
$$

* X: 정규분포를 따르는 데이터
* $\mu$, $\sigma$: 모집단의 평균과 표준편차

* **모집단의 σ를 알고 있는 경우**에 사용
* **z-값**을 기준으로 누적확률을 쉽게 찾을 수 있음 (z-table)
* **Z-분포**는 정규분포를 표준화하여 사용한 것.


| 상황        | 사용 예                |
| --------- | ------------------- |
| 정규분포를 표준화 | 다양한 단위를 공통 척도로 비교   |
| 신뢰구간 계산   | 95% 신뢰수준 → z = 1.96 |
| 가설검정      | Z-test              |



---

#### 3) t-분포 (Student's t-distribution)



정규분포와 유사하지만, **표본 수가 작고(보통 n < 30), 모집단의 σ를 모를 때** 사용함.

$$
t = \frac{\bar{x} - \mu}{s / \sqrt{n}}
$$

* $\bar{x}$: 표본 평균
* $\mu$: 모집단 평균
* $s$: 표본 표준편차
* $n$: 표본 크기
* **자유도** $df = n - 1$


| 항목        | 설명                     |
| --------- | ---------------------- |
| 중심        | 평균 0                   |
| 꼬리        | 정규분포보다 두꺼움 (더 넓은 신뢰구간) |
| 표본 수 증가 시 | t-분포 → z-분포로 수렴        |



<img src="z_vs_t_distribution.PNG">

---

#### 분포 비교

| 구분          | 정규분포  | Z-분포      | t-분포             |
| ----------- | ----- | --------- | ---------------- |
| 모집단 σ 사용 여부 | O     | O         | X                |
| 표본 크기       | 제한 없음 | 보통 n ≥ 30 | 보통 n < 30        |
| 평균          | μ     | 0         | 0                |
| 표준편차        | σ     | 1         | >1 (자유도에 따라 달라짐) |
| 꼬리 두께       | 보통    | 보통        | 두꺼움 (df 작을수록)    |

---

### (4) 기대값과 분산

| 용어          | 정의                 | 수식                                    |
| ----------- | ------------------ | ------------------------------------- |
| 기대값 $E(X)$  | 확률 변수의 평균값         | $\sum x_i P(x_i)$ 또는 $\int x f(x) dx$ |
| 분산 $Var(X)$ | 기대값과 값 간 거리의 제곱 평균 | $E[(X - \mu)^2]$                      |

---

### 요약: 확률 분포 정리

| 분포 유형  | 대표 분포           | 특징              | 적용 예시            |
| ------ | --------------- | --------------- | ---------------- |
| 이산 분포  | 이항, 포아송         | 셀 수 있는 값만 가능    | 동전 던지기, 고객 수     |
| 연속 분포  | 정규 분포           | 연속된 모든 실수 값 가능  | 키, 몸무게, 시험 점수 등  |
| 이항 분포  | $n$, $p$        | n회 시행 중 성공 횟수   | 정답 개수, 합격자 수 등   |
| 포아송 분포 | 평균 발생률 λ        | 단위 시간당 사건 발생 횟수 | 콜센터 전화 수, 사고 수   |
| 정규 분포  | $\mu$, $\sigma$ | 평균과 표준편차로 정의    | 자연현상 분포, 품질 관리 등 |

---

## ✅ 복습 문제

### Q1. 다음 중 연속 확률 분포에 해당하는 것은?

A) 주사위 눈의 합

B) 시간당 콜센터 전화 수

C) 한 사람의 키

D) 생산된 부품의 불량 여부

**정답: C**

> 키는 연속적으로 변화하며 정규 분포와 같은 연속 확률 분포로 모델링됨.

---

### Q2. 정규 분포의 확률은 무엇으로 계산되는가?

A) 확률 질량

B) 누적 횟수

C) 특정 값의 빈도

D) 특정 구간의 면적

**정답: D**

> 정규 분포는 확률 밀도 함수이며, 확률은 구간 아래 면적으로 계산됨.

---

## 💻 실습

### 문제 1) 이항 분포 시뮬레이션 및 시각화

n = 10, p = 0.5인 이항 분포의 확률 분포를 시각화하시오.

```python
import scipy.stats as stats
import matplotlib.pyplot as plt

n, p = 10, 0.5
x = range(0, n+1)
y = stats.binom.pmf(x, n, p)

plt.bar(x, y)
plt.title("이항 분포 (n=10, p=0.5)")
plt.xlabel("성공 횟수")
plt.ylabel("확률")
plt.show()
```

| 함수 / 모듈             | 설명             | 주요 파라미터       |
| ------------------- | -------------- | ------------- |
| `stats.binom.pmf()` | 이항 분포 확률 질량 함수 | `k`, `n`, `p` |
| `plt.bar()`         | 막대그래프 생성       | x값, y값        |

---
### 문제 2) 이항 분포 시뮬레이션 및 시각화

이항 분포의 n, p 값 변화에 따른 확률 분포를 시각화하시오.

이항분포는 **n번의 시행 중 k번 성공할 확률**을 나타냄.
성공 확률 p, 시행 횟수 n에 따라 분포 형태가 달라짐.

$$
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}
$$


```python
from scipy.stats import binom

params = [(10, 0.5), (20, 0.5), (20, 0.2), (20, 0.8)]
fig, axs = plt.subplots(2, 2, figsize=(10, 8))
axs = axs.flatten()

for i, (n, p) in enumerate(params):
    x = np.arange(0, n + 1)
    pmf = binom.pmf(x, n, p)
    axs[i].bar(x, pmf, color='skyblue', edgecolor='black')
    axs[i].set_title(f"n={n}, p={p}")
    axs[i].set_xlabel("성공 횟수")
    axs[i].set_ylabel("확률")
    axs[i].grid(True)

plt.suptitle("이항 분포의 n, p 변화에 따른 모양 비교")
plt.tight_layout(rect=[0, 0, 1, 0.95])
plt.show()
```

* p=0.5일 때는 대칭 분포,
* p가 0.2 또는 0.8일 경우 한쪽으로 치우친 비대칭 분포가 형성됨.
* n이 클수록 분포가 더 좁고 매끄러워짐 (정규분포와 유사해짐)

---

### 문제 3) 포아송 분포 시뮬레이션 및 시각화

λ = 4 (평균 발생 횟수)인 포아송 분포에서 사건 발생 횟수(0~14)에 대한 확률을 시각화하시오.

```python
lam = 4
x = range(0, 15)
y = stats.poisson.pmf(x, mu=lam)

plt.bar(x, y)
plt.title("포아송 분포 (λ=4)")
plt.xlabel("사건 횟수")
plt.ylabel("확률")
plt.show()
```

| 함수 / 모듈               | 설명              | 주요 파라미터            |
| --------------------- | --------------- | ------------------ |
| `stats.poisson.pmf()` | 포아송 분포 확률 질량 함수 | `x`, `mu` 또는 `lam` |
| `mu`                 | 평균 발생 횟수 λ       |     |
---

### 문제 4) 정규 분포 데이터 생성 및 히스토그램

평균 100, 표준편차 15인 정규분포 샘플 1000개 생성 및 시각화

```python
import numpy as np

data = np.random.normal(loc=100, scale=15, size=1000)

plt.hist(data, bins=30, edgecolor='black', density=True)
plt.title("정규 분포 샘플 히스토그램")
plt.xlabel("값")
plt.ylabel("밀도")
plt.show()
```

| 함수                   | 설명         | 주요 파라미터                |
| -------------------- | ---------- | ---------------------- |
| `np.random.normal()` | 정규분포 샘플 생성 | `loc`, `scale`, `size` |
| `plt.hist()`         | 히스토그램 시각화  | `density=True`로 밀도 정규화 |

---

### 문제 5) 정규 분포 확률 밀도 함수(PDF) 시각화

평균이 100이고 표준편차가 15인 정규 분포의 **확률 밀도 함수(PDF)**를 시각화하시오.


```python
import numpy as np
from scipy.stats import norm

mu = 100
sigma = 15

x = np.linspace(40, 160, 500)
pdf = norm.pdf(x, loc=mu, scale=sigma)

plt.plot(x, pdf)
plt.title("정규 분포 PDF (μ=100, σ=15)")
plt.xlabel("값")
plt.ylabel("밀도")
plt.grid(True)
plt.show()
```

| 함수/모듈                     | 설명              |
| ------------------------- | --------------- |
| `norm.pdf(x, loc, scale)` | 정규 분포의 확률 밀도 함수 |
| `np.linspace()`           | 연속형 x 구간 생성     |

---
### 문제 6) 정규분포 누적 확률(CDF) 곡선을 시각화하시오.

정규분포는 연속 확률 분포의 대표적인 예이며, **평균 μ와 표준편차 σ**로 정의됨.
누적 분포 함수(CDF)는 **값이 x 이하일 확률**을 나타내며, 다음과 같이 표현됨:

$$
P(X \leq x) = \text{CDF}(x) = \int_{-\infty}^{x} f(t) dt
$$

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import norm

x = np.linspace(40, 160, 500)
mu = 100  # 평균
sigma = 15  # 표준편차
cdf = norm.cdf(x, loc=mu, scale=sigma)

plt.figure(figsize=(8, 5))
plt.plot(x, cdf, label='CDF (μ=100, σ=15)', color='blue')
plt.title("정규분포 누적 확률 함수 (CDF)")
plt.xlabel("값")
plt.ylabel("누적 확률")
plt.grid(True)
plt.legend()
plt.show()
```

* `norm.cdf()` 함수는 해당 x값 이하의 누적 확률을 계산함.
* CDF 곡선은 **S자 형태의 곡선**으로, 확률이 0에서 1까지 점진적으로 증가함.

---

### 문제 7)  정규분포의 σ 변화에 따른 모양 변화


정규분포의 **표준편차 σ**는 분포의 퍼짐 정도를 결정함.

* σ가 작을수록 날카롭고 좁은 분포
* σ가 클수록 평평하고 넓게 퍼진 분포


평균이 100일 때, 표준편차가 5, 15, 30일 때의 정규분포 PDF를 각각 시각화하여 비교하라.


```python
from scipy.stats import norm

sigmas = [5, 15, 30]
x = np.linspace(40, 160, 500)
mu = 100

for s in sigmas:
    plt.plot(x, norm.pdf(x, loc=mu, scale=s), label=f'σ={s}')
plt.title("정규분포의 σ 증가에 따른 변화")
plt.xlabel("값")
plt.ylabel("확률 밀도")
plt.grid(True)
plt.legend()
plt.show()
```

* σ가 작을수록 중심에 더 모여 있고, σ가 클수록 넓고 평탄하게 분포됨.
* 실제로 σ가 증가하면 **데이터의 변동성이 크다**는 것을 시각적으로 확인 가능함.

---

## 7. 추론 통계의 기초

---

### (1) 추론 통계의 개념

* **추론 통계(inferential statistics)**는 표본 데이터를 바탕으로 모집단의 특성을 **추정하거나 검정**하는 통계 방법임.
* **모수(parameter)**를 직접 측정하지 않고 **통계량(statistic)**으로부터 **모집단에 대한 일반화된 결론**을 도출함.

---

### (2) 표본 통계량과 신뢰구간

#### 1) 표본 통계량 (Sample Statistic)

* 표본에서 계산된 값으로, 모수의 추정값 역할을 함. 예: 표본 평균 $\bar{x}$

#### 2) 신뢰구간 (Confidence Interval)

* 모수가 포함될 것으로 **신뢰할 수 있는 구간**을 의미함.
* 즉, 모집단의 모수를 추정할 때, 일정한 **신뢰수준(confidence level)**을 바탕으로 **"얼마나 믿을 수 있는 구간"**을 말함.


* 보통 **95% 신뢰수준**에서 다음과 같이 표현함:

  $$
  \mu \in \left[ \bar{x} - z_{\alpha/2} \cdot \frac{s}{\sqrt{n}},\ \bar{x} + z_{\alpha/2} \cdot \frac{s}{\sqrt{n}} \right]
  $$

* 여기서 $z_{\alpha/2}$: 정규분포 기준값 (예: 95% → 1.96)


#####   z-값과의 의미 비교

표준정규분포(평균 0, 표준편차 1)에서 특정 확률에 해당하는 x값을 **z-score**라고 부름.
z값은 누적확률의 경계선으로 사용되며, 신뢰구간을 구할 때 사용됨.



##### 왜 95% 신뢰수준에서 z = 1.96인가?

* 정규분포에서 누적확률이 0.025 이하인 왼쪽 영역: z = -1.96
* 누적확률이 0.975 이하인 오른쪽 영역: z = +1.96
* 따라서,

  $$
  P(-1.96 \leq Z \leq 1.96) = 0.95
  $$
* 이는 **표준정규분포에서 95% 확률이 평균을 중심으로 ±1.96 범위 내에 있다는 의미**임.


##### 신뢰구간 계산 공식

모평균 μ의 신뢰구간은 다음과 같이 계산됨:

$$
\bar{x} \pm z_{\alpha/2} \cdot \frac{\sigma}{\sqrt{n}}
$$

| 기호             | 의미                       |
| -------------- | ------------------------ |
| $\bar{x}$      | 표본평균                     |
| $z_{\alpha/2}$ | 신뢰수준에 따른 z값 (95% → 1.96) |
| $\sigma$       | 모집단 표준편차                 |
| $n$            | 표본의 크기                   |

---

##### 참고

| 개념       | 설명                                     |
| -------- | -------------------------------------- |
| 정규분포     | 평균을 중심으로 좌우 대칭적인 확률분포                  |
| 표준편차 구간  | ±1σ (68.3%), ±2σ (95.5%), ±3σ (99.7%)  |
| 95% 신뢰구간 | z = 1.96 사용, 평균 기준 약 ±1.96σ 안에 데이터가 위치 |

---

### (3) 가설 검정의 기초

* **가설 검정(hypothesis testing)**은 어떤 주장(모수에 대한 가설)이 **통계적으로 유의미한지**를 검토하는 절차임.

#### 1) 용어 정의

| 용어          | 정의                           |
| ----------- | ---------------------------- |
| 귀무가설(H₀)    | 차이가 없다는 기본 가정                |
| 대립가설(H₁)    | 차이가 존재한다는 가정                 |
| 유의수준(α)     | H₀를 기각할 최대 허용 오차 (보통 0.05)   |
| 검정통계량       | 가설 검정에 사용하는 수치 (예: Z값, t값 등) |
| p값(p-value) | 관측된 값 이상이 나올 확률              |

#### 2) 해석 기준

* p값 < α: **귀무가설 기각**, 통계적으로 유의미함
* p값 ≥ α: **귀무가설 채택**, 통계적으로 유의하지 않음

---

### 요약: 추론 통계 개념 정리

| 개념    | 정의 또는 역할                       |
| ----- | ------------------------------ |
| 추론 통계 | 표본으로 모집단 추론                    |
| 신뢰구간  | 모수가 존재할 가능성이 높은 구간             |
| 가설 검정 | 모집단에 대한 주장에 대한 검증 방법           |
| 유의수준  | 오류를 감수할 최대 확률 (보통 0.05)        |
| p값    | H₀가 참일 때 현재 결과보다 극단적인 값이 나올 확률 |

---

## ✅ 복습 문제

### Q1. 다음 중 신뢰구간에 대한 설명으로 옳은 것은?

A) 항상 참인 모수의 값만 포함한다

B) 표본마다 고정된 범위를 갖는다

C) 모수가 포함될 것으로 기대되는 구간이다

D) 신뢰구간은 분산과 무관하다

**정답: C**

> 신뢰구간은 모수가 포함될 확률이 높은 구간이며, '기대된다'는 해석이 옳음.

---

### Q2. p값이 0.02이고, 유의수준이 0.05라면 어떤 결론을 내릴 수 있는가?

A) 귀무가설을 채택한다

B) 가설 검정은 불가능하다

C) 귀무가설을 기각한다

D) 유의수준을 재설정한다

**정답: C**

> p값이 유의수준보다 작으면 귀무가설을 기각함.

---

## 💻 실습 

### 문제 1) 표본 평균 및 신뢰구간 계산

정규분포에서 표본을 추출하여 평균과 95% 신뢰구간을 구하시오.

```python
import numpy as np
import scipy.stats as stats

np.random.seed(0)
sample = np.random.normal(loc=100, scale=15, size=30)

sample_mean = np.mean(sample)
sample_std = np.std(sample, ddof=1)
n = len(sample)

z = 1.96  # 95% 신뢰수준
margin_of_error = z * (sample_std / np.sqrt(n))

ci_lower = sample_mean - margin_of_error
ci_upper = sample_mean + margin_of_error

print(f"표본 평균: {sample_mean:.2f}")
print(f"95% 신뢰구간: ({ci_lower:.2f}, {ci_upper:.2f})")
```

| 함수 / 수식                      | 설명                           |
| ---------------------------- | ---------------------------- |
| `np.mean()`                  | 표본 평균 계산                     |
| `np.std(..., ddof=1)`        | 표본 표준편차 계산                   |
| $z \cdot \frac{s}{\sqrt{n}}$ | 신뢰구간 오차 한계 (margin of error) |

---

### 문제 2) 가설 검정: 단일 평균 검정 (1표본 t-test)

모집단 평균이 100이라는 귀무가설에 대해, 표본 평균이 유의한 차이가 있는지 검정하시오.

```python
t_stat, p_value = stats.ttest_1samp(sample, popmean=100)

print(f"t통계량: {t_stat:.2f}, p값: {p_value:.4f}")
```

| 함수                    | 설명        | 주요 파라미터             |
| --------------------- | --------- | ------------------- |
| `stats.ttest_1samp()` | 1표본 평균 검정 | `sample`, `popmean` |

* t-통계량은 가설검정에서 표본 평균이 귀무가설 하의 모집단 평균에서 얼마나 떨어져 있는지를 표준오차 단위로 측정한 값
* t ≈ 0	 → 표본 평균이 귀무가설 평균과 거의 동일함
* t=2.20 → 표본 평균이 귀무가설의 평균에서 표준오차의 2.20배만큼 떨어져 있음
* p-값=0.0356 → 귀무가설이 맞다고 할 때, 현재처럼 극단적인 결과가 나올 확률은 약 3.56%
* 유의수준 0.05에서 p-값 0.0356은 작기 때문에, 귀무가설(μ = 100)을 기각함.
* 따라서, 모집단의 평균은 100이 아닐 가능성이 통계적으로 유의함.

---

### 문제 3) p값 해석 자동 판별기

t검정의 결과로 도출된 p값을 유의수준과 비교하여 자동 판별하시오.

```python
alpha = 0.05

if p_value < alpha:
    print("귀무가설 기각: 통계적으로 유의미한 차이 존재")
else:
    print("귀무가설 채택: 유의미한 차이 없음")
```

| 변수 / 조건           | 설명             |
| ----------------- | -------------- |
| `p_value < alpha` | 유의수준과 p값 비교 조건 |

---

## 8. 변수 간 관계 분석 (상관 계수)

---

### (1) 변수 간 관계의 개념

* 두 변수 간의 관계를 파악하는 것은 **인과성 여부를 탐색하거나 예측 모델을 구성**할 때 매우 중요함.
* 관계의 종류는 다음과 같음:

  * **양의 관계**: 한 변수가 증가하면 다른 변수도 증가
  * **음의 관계**: 한 변수가 증가하면 다른 변수는 감소
  * **무상관**: 두 변수 사이에 뚜렷한 연관 없음

---

### (2) 상관 계수(Correlation Coefficient)의 개념

* 상관 계수는 두 변수 간 **선형적 관계의 강도와 방향**을 수치로 나타낸 것임.
* 가장 많이 사용하는 지표는 \*\*피어슨 상관 계수(Pearson correlation coefficient)\*\*임.

#### 피어슨 상관 계수  r 정의:

- r = 공분산(x, y) / (표준편차 x * 표준편차 y)


$$
r = \frac{ \sum (x_i - \bar{x})(y_i - \bar{y}) }{ \sqrt{ \sum (x_i - \bar{x})^2 } \cdot \sqrt{ \sum (y_i - \bar{y})^2 } }
$$

* 결과값 r은 -1에서 1 사이 값을 가짐.
* r값의 해석:

| r 값 범위       | 해석       |
| ------------ | -------- |
| -1.0 \~ -0.7 | 강한 음의 상관 |
| -0.7 \~ -0.3 | 약한 음의 상관 |
| -0.3 \~ 0.3  | 거의 무상관   |
| 0.3 \~ 0.7   | 약한 양의 상관 |
| 0.7 \~ 1.0   | 강한 양의 상관 |

---

### (3) 상관 분석 시 유의사항

* 상관 계수는 **선형 관계**만 측정함.
* 상관이 있다고 해서 \*\*인과관계(causality)\*\*가 있다는 뜻은 아님.
* 이상치(outlier)는 상관 계수에 **크게 영향을 줄 수 있음**.

---

### 요약 표: 상관 분석 정리

| 항목        | 설명                          |
| --------- | --------------------------- |
| 상관 계수 r   | 선형 관계 강도와 방향을 나타내는 지표       |
| r = 1     | 완전한 양의 선형 관계                |
| r = -1    | 완전한 음의 선형 관계                |
| r ≈ 0     | 선형 관계 없음 (무상관)              |
| 피어슨 상관 계수 | 연속형 변수 간의 선형 관계 측정          |
| 유의사항      | 이상치 영향 큼, 인과관계 아님, 비선형은 부적절 |

---

## ✅ 복습 문제

### Q1. 상관 계수 r이 -0.85라면 두 변수 간의 관계는?

A) 무상관

B) 약한 양의 상관

C) 강한 음의 상관

D) 약한 음의 상관

**정답: C**

> r이 -0.85이면 -1.0 \~ -0.7 범위에 해당하므로 강한 음의 선형 관계가 있음.

---

### Q2. 다음 중 상관 계수에 대한 설명으로 옳지 않은 것은?

A) r은 항상 -1 이상 1 이하이다

B) r이 0이면 선형 관계가 없다

C) r이 1이면 두 변수는 인과관계가 있다

D) 이상치는 r 값에 영향을 줄 수 있다

**정답: C**

> 상관 계수는 관계의 강도를 나타낼 뿐, 인과관계를 보장하지 않음.

---

## 💻 실습

### 문제 1) 피어슨 상관 계수 계산

두 연속형 변수의 상관 계수를 직접 계산하시오.

```python
import numpy as np
from scipy.stats import pearsonr

x = [10, 20, 30, 40, 50]
y = [15, 25, 35, 45, 55]

r, p = pearsonr(x, y)

print(f"피어슨 상관 계수 r: {r:.2f}, p값: {p:.4f}")
```

| 함수           | 설명                    | 주요 파라미터        |
| ------------ | --------------------- | -------------- |
| `pearsonr()` | 피어슨 상관 계수 및 유의성 검정 계산 | 두 개의 리스트 또는 배열 |

---

### 문제 2) 상관 행렬 시각화

여러 변수 간의 상관 계수를 한 번에 확인하는 행렬을 생성하고 시각화하시오.

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

df = pd.DataFrame({
    '수학': [90, 85, 78, 92, 88],
    '과학': [91, 89, 75, 95, 90],
    '영어': [80, 70, 65, 85, 78]
})

corr_matrix = df.corr()
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm')
plt.title("과목 간 상관 관계")
plt.show()
```

| 함수                 | 설명                  | 주요 파라미터           |
| ------------------ | ------------------- | ----------------- |
| `DataFrame.corr()` | 상관 계수 행렬 계산         | 없음                |
| `sns.heatmap()`    | 행렬 형태의 수치 시각화 (히트맵) | `annot`, `cmap` 등 |

---

### 문제 3) 이상치의 영향 실험

데이터에 이상치를 추가하기 전후의 상관 계수를 비교하시오.

```python
x = [1, 2, 3, 4, 5]
y = [2, 4, 6, 8, 10]

r1, _ = pearsonr(x, y)

# 이상치 추가
y_outlier = [2, 4, 6, 8, 100]
r2, _ = pearsonr(x, y_outlier)

print(f"이상치 전 상관 계수: {r1:.2f}")
print(f"이상치 후 상관 계수: {r2:.2f}")
```

| 내용       | 설명                   |
| -------- | -------------------- |
| 이상치 추가 전 | 완벽한 양의 선형 관계 → r ≈ 1 |
| 이상치 추가 후 | 상관 계수 급격히 감소 가능      |

---
# 부록. Colab 주피터노트북에서 그래프에 한글 출력하기


## 1. Colab에서의 한글 깨짐 문제

Google Colab은 클라우드 기반 환경으로 한글 폰트가 기본적으로 설치되어 있지 않아, `matplotlib`이나 `seaborn`을 사용할 때 **그래프 내 텍스트(레이블, 제목 등)가 깨지는 현상**이 발생할 수 있습니다.

---
## 2. Colab에서 한글 폰트 설치하기

```python
# 한글 폰트 설치 (NanumGothic)
!apt-get -qq install -y fonts-nanum
!fc-cache -fv
!rm ~/.cache/matplotlib -rf
```

> 위 코드는 Colab 셀에서 **한 번만 실행하면 설치**됩니다. 
> 폰트 설치 후 반드시 런타임 재시작 (Ctrl + M .)합니다.
---

## 3. Matplotlib에 한글 폰트 설정하기

```python
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px

plt.rcParams['font.family'] = 'NanumGothic'  # 한글 폰트 설정
plt.rcParams['axes.unicode_minus'] = False  # 마이너스 기호 깨짐 방지
```

---

## 4. 한글 출력 테스트

```python
x = ['사과', '바나나', '포도']
y = [10, 20, 15]

plt.bar(x, y)
plt.title('과일 판매량')
plt.xlabel('과일 종류')
plt.ylabel('판매 수량')
plt.show()
```
---

